# PC

![首页拓展](/img/首页拓展.png)

## 扩展点概览

NEX 2.0 首页拓展提供了丰富的扩展点，开发者可以通过这些扩展点实现对系统界面和功能的定制化开发。以下是主要扩展点的详细说明：

[[toc]]

## 1. ✅系统框架（neoUIFramework）

系统框架提供了整体框架的扩展能力，可以在框架加载的关键节点进行功能扩展。

### 1.1 事件

|     扩展点     |        apiKey        |       使用场景       | 读写性 |
| :------------: | :------------------: | :------------------: | :----: |
| 框架加载完成后 | `afterFrameworkLoad` | 当框架加载完成后执行 |   -    |

**示例代码**：

```js
// 框架加载完成后执行
ctx.neoUIFramework.on("afterFrameworkLoad", function () {
  // 初始化自定义功能
  ctx.util.log("框架加载完成，开始初始化自定义功能");
  // 执行初始化逻辑
});
```

## 2. ✅浏览器（browser）

浏览器对象提供了对浏览器窗口相关属性的扩展能力。

### 2.1 属性-规则

|      扩展点       |    apiKey     |                    使用场景                    |   读写性   |
| :---------------: | :-----------: | :--------------------------------------------: | :--------: |
| 标题后缀（中/英） | `titleSuffix` | 设置浏览器页面标题的后缀，如不设置则为"Neocrm" | 可静态配置 |
|     标题图标      |  `titleIcon`  | 设置浏览器标题前的图标，可以设置一个 ico 地址  | 可静态配置 |

**示例代码**：

```js
// 设置浏览器标题后缀和图标
browser: {
    titleSuffix: '鸡你太美', // 任意修改文字，可修改为公司名称
    titleIcon: 'https://th.bing.com/th/id/OIP.KAF0cB2S-CNAN5bUU9ENiAHaHp?rs=1&pid=ImgDetMain' //网络路径的ico格式图片
}
```

**效果展示**：

![修改后的网站标题和图标](/img/修改网站内容和icon.png)

## 3. ✅工具栏（toolbar）

工具栏位于页面顶部，提供了全局操作和功能入口。

### 3.1 属性-规则

|       扩展点       |      apiKey       |                 使用场景                  |   读写性   |
| :----------------: | :---------------: | :---------------------------------------: | :--------: |
| 是否显示应用切换器 | `showAppLauncher` |           是否显示应用切换选项            | 可静态配置 |
|  是否显示帮助菜单  |  `showHelpMenu`   | 是否显示帮助菜单及其下级菜单，默认为 true | 可静态配置 |
|  是否显示工单反馈  |   `showLogCase`   |     是否显示工单反馈按钮，默认为 true     | 可静态配置 |

**示例代码**：

```js
// 配置工具栏显示选项
toolbar: {
    showAppLauncher: false,
    //是否显示应用切换选项
    showHelpMenu: false,
    //显示帮助菜单以及其下级的菜单，默认为true
    showLogCase: false
    //显示工单反馈按钮，默认为true
}
```

## ~~4. ❌菜单栏（navigationBar）~~

没研究出来这有什么鸟用

## ~~5. ❌菜单项（menu）~~

菜单项是菜单栏中的具体功能入口。

没看出来怎么使用，建议 pass

### 5.1 属性-规则

|    扩展点    |  apiKey   |           使用场景           |   读写性   |
| :----------: | :-------: | :--------------------------: | :--------: |
| 菜单唯一标识 | `menuKey` | 菜单的唯一标识，用于定位菜单 | 可静态配置 |
|   菜单名称   |  `name`   |        菜单的显示名称        | 可静态配置 |
|   是否显示   | `visible` |         菜单是否可见         | 可静态配置 |

**示例代码**：

```js
// 添加自定义菜单
navigationBar: {
  menu: [
    {
      menuKey: "common.app.workreportstatistic",
      //菜单的唯一标识
      name: "Nex111",
      visible: true, //是否显示
    },
  ];
}
```

## 6. ✅全局操作组（globalActions）

全局操作组是一组浮动的操作按钮，通常位于页面右侧或底部。

### 6.1 属性-规则

|  扩展点  |       apiKey       |                                   使用场景                                   |   读写性   |
| :------: | :----------------: | :--------------------------------------------------------------------------: | :--------: |
| 悬浮位置 |     `position`     |               按钮悬浮区域，可选项为 left、right，默认为 right               | 可静态配置 |
| 排列方式 |    `alignment`     |      内部按钮的对齐方式，可选项为 vertical、horizontal，默认为 vertical      | 可静态配置 |
| 水平边距 | `horizontalMargin` | 按钮组在水平方向距离悬浮边缘的宽度，移动端最小值是 16px，网页端最小值是 40px | 可静态配置 |
| 垂直边距 |  `verticalMargin`  |    按钮在垂直方向距离底部的高度，移动端最小值是 24px，网页端最小值是 40px    | 可静态配置 |
|   尺寸   |       `size`       |      设置组内操作项的尺寸，可选项为 large、normal、small，默认为 normal      | 可静态配置 |
|  圆角度  |      `radius`      |             设置按钮是否有圆角，可设置以 px 单位的值，默认为 0px             | 可静态配置 |

### 6.2 事件

|   扩展点   |    apiKey     |                   使用场景                   | 读写性 |
| :--------: | :-----------: | :------------------------------------------: | :----: |
| 渲染完成后 | `afterRender` | 操作组渲染完成后触发的事件，可以执行 js 代码 |   -    |

**示例代码**：

```js
{
    "globalActions": {
        "position": "right",
        "alignment": "horizontal",
        "horizontalMargin": 100,
        "verticalMargin": 100,
        "size": "small",
        "radius": 30,
        "globalAction": [
            {
                "icon": "Account",
                "name": "客户nex",
                "buttonApiKey": "account",
                "style": {
                    "iconColor": "#fff",
                    "backgroundColor": "#0564F5"
                }
            },
            {
                "icon": "Aiming",
                "buttonApiKey": "Aiming",
                "visible": false,
                "style": {
                    "iconColor": "#fff",
                    "backgroundColor": "#0564F5"
                }
            },
            {
                "icon": "AlarmClock",
                "buttonApiKey": "AlarmClock",
                "style": {
                    "iconColor": "#fff",
                    "backgroundColor": "#0564F5"
                }
            }
        ]
    }
}
```

## 7. ✅全局操作按钮（globalAction）

全局操作按钮是全局操作组中的具体操作按钮。

### 7.1 属性-规则

|  扩展点  |     apiKey     |                                         使用场景                                         |   读写性   |
| :------: | :------------: | :--------------------------------------------------------------------------------------: | :--------: |
|   图标   |     `icon`     |                     必须设置一个按钮的显示 icon，可以设置 Icon 名称                      | 可静态配置 |
|   样式   |    `style`     |            可以设置 icon 的颜色和背景色，icon 颜色默认为蓝色，背景默认为白色             | 可静态配置 |
| 按钮名称 |     `name`     |                          按钮的名称，鼠标悬浮后可以显示按钮名称                          | 可静态配置 |
| API 名称 | `buttonApiKey` |                                      按钮的唯一标识                                      | 可静态配置 |
| 是否显示 |   `visible`    | 设置按钮是否显示，可以使用表达式作为显示条件。如果没有任何按钮可显示，则操作组也不会显示 | 可静态配置 |

### 7.2 事件

|   扩展点   |  apiKey   |                      使用场景                       | 读写性 |
| :--------: | :-------: | :-------------------------------------------------: | :----: |
| 鼠标悬浮后 | `onHover` | 鼠标悬浮在按钮上以后可执行 js 代码，仅在 web 端生效 |   -    |
|   点击后   | `onClick` |       单击按钮后触发的事件，可以执行 js 代码        |   -    |

**示例代码**：

```js
// 添加全局操作按钮
{
    "globalAction": [
        {
            "icon": "Account",
            "name": "客户nex",
            "buttonApiKey": "account",
            "style": {
                "iconColor": "#fff",
                "backgroundColor": "#0564F5"
            },
            "onClick": function() {
                ctx.util.log("客户nex 按钮被点击");
                // 可以添加更多逻辑
            }
        },
        {
            "icon": "Aiming",
            "buttonApiKey": "Aiming",
            "visible": false,
            "style": {
                "iconColor": "#fff",
                "backgroundColor": "#0564F5"
            }
        },
        {
            "icon": "AlarmClock",
            "buttonApiKey": "AlarmClock",
            "style": {
                "iconColor": "#fff",
                "backgroundColor": "#0564F5"
            },
            "onHover": function() {
                ctx.util.log("AlarmClock 鼠标悬浮");
                // 可以添加更多逻辑
            }
        }
    ]
}
```

## 开发最佳实践

1. **权限控制**：在使用扩展点时，应考虑不同用户角色的权限要求，确保功能对应的用户可见和可用。

2. **性能优化**：避免在框架加载完成事件中执行过多耗时操作，以免影响系统启动速度。

3. **样式一致性**：自定义按钮和菜单的样式应与系统整体风格保持一致，提供良好的用户体验。

4. **错误处理**：在事件处理函数中添加适当的错误捕获机制，避免因错误导致整个功能不可用。

5. **动态配置**：对于需要根据条件动态显示的元素，使用表达式或函数返回值来控制其可见性，而不是静态配置。

## 实际应用场景

1. **自定义导航**：根据企业业务流程，定制专属的导航菜单和快捷操作。

2. **品牌定制**：通过配置浏览器标题和图标，实现系统的品牌化定制。

3. **快捷工具**：添加全局操作按钮，提供常用功能的快速访问入口。

4. **个性化体验**：根据用户角色和权限，动态显示或隐藏特定的功能入口。
